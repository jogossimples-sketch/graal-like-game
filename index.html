<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, orientation=landscape">
    <title>Graal-like Game - Minera√ß√£o</title>
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            overflow: hidden; 
            touch-action: manipulation;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
        }
        canvas { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100vw; 
            height: 100vh; 
            display: block;
        }
        .ui-btn {
            position: fixed;
            width: 65px;
            height: 65px;
            border-radius: 50%;
            background: rgba(0,0,0,0.7);
            border: 2px solid #fff;
            color: #fff;
            font-size: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            touch-action: manipulation;
        }
        #btn-left { left: 25px; bottom: 25px; }
        #btn-right { left: 110px; bottom: 25px; }
        #btn-up { left: 67px; bottom: 95px; }
        #btn-down { left: 67px; bottom: 25px; }
        #btn-glove { right: 25px; bottom: 25px; }
        #btn-item { right: 25px; bottom: 100px; }
        #btn-pickaxe { right: 25px; top: 25px; } /* Bot√£o da picareta */
        .ui-hud {
            position: fixed;
            top: 25px;
            left: 25px;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border: 2px solid #fff;
            color: #fff;
            font-size: 18px;
            z-index: 10;
        }
    </style>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
<script>
const game = new Phaser.Game({
    type: Phaser.CANVAS,
    width: window.innerWidth,
    height: window.innerHeight,
    scene: {
        create: function() {
            // === HUD DE RECURSOS ===
            this.resources = {
                pedra: 0,
                ouro: 0
            };
            this.hud = document.createElement('div');
            this.hud.className = 'ui-hud';
            this.updateHud = () => {
                this.hud.innerHTML = `üèîÔ∏è Pedra: ${this.resources.pedra}<br>üí∞ Ouro: ${this.resources.ouro}`;
            };
            this.hud.innerHTML = `üèîÔ∏è Pedra: 0<br>üí∞ Ouro: 0`;
            document.body.appendChild(this.hud);

            // === MAPA ===
            const gfx = this.add.graphics();
            // Grama
            for(let x=0; x<this.game.config.width; x+=32) {
                for(let y=0; y<this.game.config.height; y+=32) {
                    gfx.fillStyle(0x28a038);
                    gfx.fillRect(x,y,32,32);
                    gfx.fillStyle(0x208028);
                    gfx.fillRect(x+4,y+4,6,6);
                }
            }
            // Pedras para minera√ß√£o (aleat√≥rias no mapa)
            this.rocks = [];
            for(let i=0; i<10; i++) {
                const rock = this.add.graphics();
                const x = Phaser.Math.Between(64, this.game.config.width - 64);
                const y = Phaser.Math.Between(64, this.game.config.height - 64);
                rock.x = x;
                rock.y = y;
                // Desenhar pedra
                rock.fillStyle(0x808080);
                rock.fillCircle(0,0,30);
                rock.fillStyle(0x696969);
                rock.fillCircle(-10,-10,10);
                rock.fillCircle(15,5,8);
                this.rocks.push({
                    gfx: rock,
                    vida: 3, // Precisa 3 golpes para minerar
                    tipo: Phaser.Math.Between(0, 1) // 0=pedra, 1=ouro
                });
            }

            // === PERSONAGEM ===
            this.player = this.add.graphics();
            this.player.x = this.game.config.width/2;
            this.player.y = this.game.config.height/2;
            const drawPlayer = () => {
                this.player.clear();
                this.player.fillStyle(0x1e90ff);
                this.player.fillCircle(0,0,40);
                this.player.fillStyle(0xffffff);
                this.player.fillCircle(0,-15,25);
                this.player.fillStyle(0x000000);
                this.player.fillRect(-10,-20,8,8);
                this.player.fillRect(10,-20,8,8);
            };
            drawPlayer();

            // === CONTROLES ===
            // Movimento
            document.getElementById('btn-left').addEventListener('touchstart', () => { this.player.x -= 8; drawPlayer(); });
            document.getElementById('btn-right').addEventListener('touchstart', () => { this.player.x += 8; drawPlayer(); });
            document.getElementById('btn-up').addEventListener('touchstart', () => { this.player.y -= 8; drawPlayer(); });
            document.getElementById('btn-down').addEventListener('touchstart', () => { this.player.y += 8; drawPlayer(); });
            // A√ß√µes
            document.getElementById('btn-glove').addEventListener('touchstart', () => {
                this.player.fillStyle(0xff0000);
                this.player.fillCircle(0,0,45);
                setTimeout(drawPlayer, 200);
            });
            document.getElementById('btn-item').addEventListener('touchstart', () => {
                this.player.fillStyle(0xffff00);
                this.player.fillCircle(0,0,45);
                setTimeout(drawPlayer, 200);
            });
            // Minera√ß√£o com picareta
            document.getElementById('btn-pickaxe').addEventListener('touchstart', () => {
                // Verificar se tem pedra perto
                this.rocks.forEach((rock, idx) => {
                    const dist = Phaser.Math.Distance.Between(
                        this.player.x, this.player.y,
                        rock.gfx.x, rock.gfx.y
                    );
                    if(dist < 80) { // Se estiver perto o suficiente
                        rock.vida -= 1;
                        // Efeito visual na pedra
                        rock.gfx.clear();
                        rock.gfx.fillStyle(0xffa500);
                        rock.gfx.fillCircle(0,0,30);
                        setTimeout(() => {
                            rock.gfx.clear();
                            rock.gfx.fillStyle(0x808080);
                            rock.gfx.fillCircle(0,0,30);
                            rock.gfx.fillStyle(0x696969);
                            rock.gfx.fillCircle(-10,-10,10);
                            rock.gfx.fillCircle(15,5,8);
                        }, 200);
                        // Se destruiu a pedra
                        if(rock.vida <= 0) {
                            rock.gfx.destroy();
                            this.rocks.splice(idx, 1);
                            // Dar recompensa
                            if(rock.tipo === 0) {
                                this.resources.pedra += 1;
                            } else {
                                this.resources.ouro += 1;
                            }
                            this.updateHud();
                            // Criar nova pedra depois de tempo
                            setTimeout(() => {
                                const newRock = this.add.graphics();
                                const x = Phaser.Math.Between(64, this.game.config.width - 64);
                                const y = Phaser.Math.Between(64, this.game.config.height - 64);
                                newRock.x = x;
                                newRock.y = y;
                                newRock.fillStyle(0x808080);
                                newRock.fillCircle(0,0,30);
                                newRock.fillStyle(0x696969);
                                newRock.fillCircle(-10,-10,10);
                                newRock.fillCircle(15,5,8);
                                this.rocks.push({
                                    gfx: newRock,
                                    vida: 3,
                                    tipo: Phaser.Math.Between(0,1)
                                });
                            }, 5000);
                        }
                    }
                });
            });
        }
    }
});
</script>

<!-- Bot√µes de controle -->
<div class="ui-btn" id="btn-left">‚Üê</div>
<div class="ui-btn" id="btn-right">‚Üí</div>
<div class="ui-btn" id="btn-up">‚Üë</div>
<div class="ui-btn" id="btn-down">‚Üì</div>
<div class="ui-btn" id="btn-glove">üëä</div>
<div class="ui-btn" id="btn-item">üíé</div>
<div class="ui-btn" id="btn-pickaxe">‚õèÔ∏è</div> <!-- Bot√£o da picareta -->

</body>
</html>
